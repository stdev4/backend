name: Test Docker Build
on:
  push:
    branches:
      - test/test-ecr

  # 수동 실행 옵션
  workflow_dispatch:

jobs:
  verify-dockerfile:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Check if Dockerfile exists
        run: |
          if [ -f "Dockerfile" ]; then
            echo "✅ Dockerfile exists in the root directory"
            echo "Dockerfile content:"
            cat Dockerfile
          else
            echo "❌ Dockerfile not found in the root directory"
            echo "Listing files in current directory:"
            ls -la
            exit 1
          fi

      - name: Test Docker build
        run: |
          echo "Starting Docker build test..."
          docker build -t test-image .
          echo "✅ Docker build successful!"
          
          echo "Docker image details:"
          docker images test-image
